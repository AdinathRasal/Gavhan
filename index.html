<!DOCTYPE html>
<html lang="mr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡§ó‡§µ‡•ç‡§π‡§æ‡§£ ‡§ï‡•ã‡§ü‡•á‡§∂‡§®</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f4f9ff;
      margin: 0;
      padding: 0;
    }

    .container {
      width: 400px;
      max-width: 700px;
      margin: 20px auto;
      background: #fff;
      padding: 25px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      border-radius: 10px;
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
    }

    .step {
      display: none;
      flex-direction: column;
      animation: fade 0.3s ease-in-out;
    }

    .step.active {
      display: flex;
    }

    label {
      margin: 10px 0 5px;
      font-weight: bold;
      font-size: 18px;
    }

    select,
    input[type="number"],
    input[type="text"],
    input[type="tel"] {
      padding: 12px;
      margin-bottom: 20px;
      width: 100%;
      box-sizing: border-box;
      font-size: 18px;
    }

    .btn {
      background-color: #007bff;
      color: white;
      padding: 14px 25px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 18px;
      margin: 10px 0;
    }

    .btn:hover {
      background-color: #0056b3;
    }

    .reset {
      background-color: #dc3545;
    }

    .reset:hover {
      background-color: #b52a37;
    }

    .button-group {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 10px;
    }

    .btn.large {
      padding: 16px 20px;
      font-size: 18px;
      width: 48%;
    }

    .summary-content {
      font-size: 18px;
      background-color: #f9f9f9;
      border-radius: 8px;
      padding: 20px;
      line-height: 1.8;
      box-shadow: 0 0 8px rgba(0, 0, 0, 0.05);
    }

    #total {
      text-align: center;
      font-size: 28px;
      font-weight: bold;
      color: #333;
      margin-top: 10px;
    }

    .mic-btn {
      background-color: #28a745;
      color: white;
      border: none;
      padding: 10px;
      border-radius: 5px;
      margin-left: 10px;
      cursor: pointer;
    }

    @keyframes fade {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @media (max-width: 480px) {
      .btn.large {
        width: 100%;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>‡§ó‡§µ‡•ç‡§π‡§æ‡§£ ‡§ï‡•ã‡§ü‡•á‡§∂‡§®</h1>

    <div class="step active" id="step2">
      <label>‡§ó‡§µ‡•ç‡§π‡§æ‡§£ ‡§Ü‡§ï‡§æ‡§∞ ‡§®‡§ø‡§µ‡§°‡§æ:</label>
      <div class="button-group">
        <button class="btn large" onclick="selectPipeSize(400)">400 mm</button>
        <button class="btn large" onclick="selectPipeSize(600)">600 mm</button>
        <button class="btn large" onclick="selectPipeSize(700)">700 mm</button>
        <button class="btn large" onclick="selectPipeSize(800)">800 mm</button>
      </div>
    </div>

    <div class="step" id="step3">
      <label>‡§ó‡§µ‡•ç‡§π‡§æ‡§£ ‡§ö‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ:</label>
      <select id="pipeQty" onchange="setupNextSteps()"></select>
      <button class="btn" onclick="nextStep()">‡§™‡•Å‡§¢‡•á</button>
    </div>

    <div class="step" id="step4">
      <div id="stand_types"> </div>
    </div>

    <div class="step" id="step5">
      <div id="standOptions"></div>
    </div>

    <div class="step" id="step6">
      <label>‡§∏‡§æ‡§á‡§° ‡§ï‡•Ö‡§™‡•ç‡§∏‡§ö‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ:</label>
      <select id="capsQty"></select>
      <button class="btn" onclick="showSummary()">‡§™‡•Å‡§¢‡•á</button>
    </div>

    <div class="step" id="step7" style="width:400px; max-width:400px;">
      <div id="summary" class="summary-content"></div>

      <label for="transportCost">‡§µ‡§æ‡§π‡§§‡•Ç‡§ï ‡§ñ‡§∞‡•ç‡§ö (‚Çπ):</label>
      <input type="number" id="transportCost" oninput="updateTotal()">

      <div id="total"></div>
      <label>‡§ó‡•ç‡§∞‡§æ‡§π‡§ï‡§æ‡§ö‡•á ‡§®‡§æ‡§µ:</label>
      <div style="display: flex;">
        <input type="text" id="customerName" placeholder="‡§®‡§æ‡§µ ‡§≤‡§ø‡§π‡§æ">
        <button class="mic-btn" onclick="startVoice()">üé§</button>
      </div>

      <label>‡§Æ‡•ã‡§¨‡§æ‡§à‡§≤ ‡§®‡§Ç‡§¨‡§∞:</label>
      <div style="display: flex;">
        <input type="tel" id="customerPhone" placeholder="10 ‡§Ö‡§Ç‡§ï‡•Ä ‡§®‡§Ç‡§¨‡§∞">
        <button class="mic-btn" onclick="startVoicePhone()">üé§</button>
      </div>

      <label>‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§∏‡•ç‡§•‡§ø‡§§‡•Ä:</label>
      <div style="margin-bottom:10px;">
        <input type="radio" id="paymentGiven" name="paymentStatus" value="‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§¶‡§ø‡§≤‡•á">
        <label for="paymentGiven">‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§¶‡§ø‡§≤‡•á</label><br>
        <input type="radio" id="paymentPending" name="paymentStatus" value="‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§¨‡§æ‡§ï‡•Ä" checked>
        <label for="paymentPending">‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§¨‡§æ‡§ï‡•Ä</label>

      </div>

      <div>
        <label for="paidAmount">‡§¶‡§ø‡§≤‡•á‡§≤‡•Ä ‡§∞‡§ï‡•ç‡§ï‡§Æ (‚Çπ):</label>
        <input type="number" id="paidAmount" style="width:100%; padding:10px; font-size:16px;"
          placeholder="‡§è‡§ï‡•Ç‡§£ ‡§∞‡§ï‡•ç‡§ï‡§Æ ‡§Ü‡§™‡•ã‡§Ü‡§™ ‡§Ø‡•á‡§à‡§≤">
      </div>

      <button class="btn" onclick="generateInvoiceImage()">‡§ï‡•ã‡§ü‡•á‡§∂‡§® ‡§á‡§Æ‡•á‡§ú ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ</button>
      <button class="btn" onclick="openWhatsAppChat()">‡§µ‡•ç‡§π‡§æ‡§ü‡•ç‡§∏‡§Ö‚Äç‡•Ö‡§™ ‡§ö‡•Ö‡§ü ‡§â‡§ò‡§°‡§æ</button>
      <button class="btn reset" onclick="resetForm()">‡§∞‡•Ä‡§∏‡•á‡§ü</button>


    </div>
    <div id="invoicePreview"
      style="display:none; background:#fff; padding:20px; width:500px; max-width:500px; box-sizing:border-box;">
    </div>


  </div>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>


  <script>
    let currentStep = 2;
    let selectedPipeSize = null;
    let selectedStandShape = null;
    let selectedYStandWidth = null;
    let step_numder = 2

    const prices = {
      pipe: { 400: 1000, 600: 1400, 700: 1900, 800: 2200 },
      stand: {
        400: 200,
        600: { Square: 500, Y6: 450, Y4: 350 },
        700: { Square: 600, Y: 500 },
        800: 900
      },
      cap: { 400: 50, 600: 100, 700: 150, 800: 250 }
    };

    function nextStep() {
      document.getElementById(`step${currentStep}`).classList.remove("active");
      currentStep++;
      document.getElementById(`step${currentStep}`).classList.add("active");

    }

    function selectPipeSize(size) {
      selectedPipeSize = size;
      populatePipeQty();
      nextStep();
      const xyz = document.getElementById('stand_types');

      if (size === 400 || size == 800) {

        xyz.innerHTML = `
        <label>‡§∏‡•ç‡§ü‡§Å‡§°‡§ö‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§®‡§ø‡§µ‡§°‡§æ:</label>
        <div class="button-group">
        <button class="btn large" onclick="selectStandShape('Square')">‡§ö‡•å‡§ï‡•ã‡§®‡•Ä</button>
        </div>`
      }

      else {
        xyz.innerHTML = `
        <label>‡§∏‡•ç‡§ü‡§Å‡§°‡§ö‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§®‡§ø‡§µ‡§°‡§æ:</label>
        <div class="button-group">
        <button class="btn large" onclick="selectStandShape('Square')">‡§ö‡•å‡§ï‡•ã‡§®‡•Ä</button>
        <button class="btn large" onclick="selectStandShape('Y')">Y</button>
        </div>`
      }
    }

    function selectStandShape(shape) {
      selectedStandShape = shape;

      if (selectedPipeSize === 600 && shape === 'Y') {
        showYStandOptions();
      } else {
        populateStandQty();
        nextStep();
      }
    }

    function setupNextSteps() {
      if (selectedStandShape === 'Y' && selectedPipeSize === 600) {
        showYStandOptions();
      } else {
        populateStandQty();
      }
    }

    function showYStandOptions() {
      const container = document.getElementById("standOptions");
      container.innerHTML = `
        <label>Y ‡§∏‡•ç‡§ü‡§Å‡§°‡§ö‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§®‡§ø‡§µ‡§°‡§æ:</label>
        <div class="button-group">
          <button class="btn large" onclick="selectYStand('Y6')">6 ‡§á‡§Ç‡§ö</button>
          <button class="btn large" onclick="selectYStand('Y4')">4 ‡§á‡§Ç‡§ö</button>
        </div>
      `;
      document.getElementById("step4").classList.remove("active");
      currentStep = 5;
      document.getElementById("step5").classList.add("active");
    }

    function selectYStand(width) {
      selectedYStandWidth = width;
      const label = width === 'Y6' ? '6 ‡§á‡§Ç‡§ö Y ‡§∏‡•ç‡§ü‡§Å‡§°‡§ö‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ:' : '4 ‡§á‡§Ç‡§ö Y ‡§∏‡•ç‡§ü‡§Å‡§°‡§ö‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ:';
      const qty = parseInt(document.getElementById("pipeQty").value);
      const container = document.getElementById("standOptions");
      container.innerHTML = `
        <label>${label}</label>
        <select id="standQty"></select>
        <button class="btn" onclick="nextStep()">‡§™‡•Å‡§¢‡•á</button>
      `;
      const s = document.getElementById("standQty");
      for (let i = 0; i <= 100; i++) {
        const opt = document.createElement("option");
        opt.value = i;
        opt.text = i;
        if (i === qty + 1) opt.selected = true;
        s.appendChild(opt);
      }
    }

    function populateStandQty() {
      const qty = parseInt(document.getElementById("pipeQty").value);
      const container = document.getElementById("standOptions");
      container.innerHTML = `
        <label>‡§∏‡•ç‡§ü‡§Å‡§° ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ:</label>
        <select id="standQty"></select>
        <button class="btn" onclick="nextStep()">‡§™‡•Å‡§¢‡•á</button>
      `;
      const s = document.getElementById("standQty");
      s.innerHTML = "";
      for (let i = 0; i <= 100; i++) {
        const opt = document.createElement("option");
        opt.value = i;
        opt.text = i;
        if (i === qty + 1) opt.selected = true;
        s.appendChild(opt);
      }
    }
    function updateTotal() {
      const pipeQty = parseInt(document.getElementById("pipeQty").value);
      const standQty = parseInt(document.getElementById("standQty").value);
      const capsQty = parseInt(document.getElementById("capsQty").value);
      const transport = parseInt(document.getElementById("transportCost")?.value || 0);


      const pipePrice = prices.pipe[selectedPipeSize];
      let standPrice;
      if (selectedPipeSize === 400) {
        standPrice = prices.stand[400];
      }
      else if (selectedPipeSize === 800) {
        standPrice = prices.stand[800];
      }
      else if (selectedStandShape === 'Y' && selectedPipeSize === 600) {
        standPrice = prices.stand[600][selectedYStandWidth];
      } else {
        standPrice = prices.stand[selectedPipeSize][selectedStandShape];
      }


      const capPrice = prices.cap[selectedPipeSize];
      const total = pipeQty * pipePrice + standQty * standPrice + capsQty * capPrice + transport;

      document.getElementById("total").textContent = `‡§è‡§ï‡•Ç‡§£: ‚Çπ${total}/-`;

      const transportLine = document.getElementById("transportLine");
      if (transportLine) {
        if (transport > 0) {
          transportLine.style.display = "block";
          transportLine.textContent = `‡§µ‡§æ‡§π‡§§‡•Ç‡§ï ‡§ñ‡§∞‡•ç‡§ö: ‚Çπ${transport}`;
        } else {
          transportLine.style.display = "none";
        }
      }
    }

    function showSummary() {
      const pipeQty = parseInt(document.getElementById("pipeQty").value);
      const standQty = parseInt(document.getElementById("standQty").value);
      const capsQty = parseInt(document.getElementById("capsQty").value);
      const pipePrice = prices.pipe[selectedPipeSize];

      let standPrice, standLabel;
      if (selectedPipeSize === 400) {
        standPrice = prices.stand[400];
        standLabel = "‡§∏‡•ç‡§ü‡§Å‡§°";
      }
      else if (selectedPipeSize === 800) {
        standPrice = prices.stand[800];
        standLabel = "‡§∏‡•ç‡§ü‡§Å‡§°";
      }
      else if (selectedStandShape === 'Y' && selectedPipeSize === 600) {
        standPrice = prices.stand[600][selectedYStandWidth];
        standLabel = selectedYStandWidth === 'Y6' ? '6 ‡§á‡§Ç‡§ö Y ‡§∏‡•ç‡§ü‡§Å‡§°' : '4 ‡§á‡§Ç‡§ö Y ‡§∏‡•ç‡§ü‡§Å‡§°';
      } else {
        standPrice = prices.stand[selectedPipeSize][selectedStandShape];
        standLabel = selectedStandShape === 'Square' ? '‡§ö‡•å‡§ï‡•ã‡§®‡•Ä ‡§∏‡•ç‡§ü‡§Å‡§°' : `${selectedStandShape} ‡§∏‡•ç‡§ü‡§Å‡§°`;
      }

      const capPrice = prices.cap[selectedPipeSize];
      const transport = parseInt(document.getElementById("transportCost")?.value || 0);

      const pipeTotal = pipeQty * pipePrice;
      const standTotal = standQty * standPrice;
      const capTotal = capsQty * capPrice;
      const total = pipeTotal + standTotal + capTotal + transport;




      document.getElementById("summary").innerHTML = `
		<table style="width:400px; max-width:400px; table-layout:fixed; border-collapse: collapse; word-wrap:break-word;">
		  <thead>
			<tr style="background-color: #eef;">
			  <th style="border: 1px solid #ccc; padding: 8px; ">‡§µ‡§∏‡•ç‡§§‡•Ç</th>
			  <th style="border: 1px solid #ccc; padding: 8px; ">‡§®‡§ó</th>
			  <th style="border: 1px solid #ccc; padding: 8px; ">‡§¶‡§∞</th>
			  <th style="border: 1px solid #ccc; padding: 8px; ">‡§∞‡§ï‡•ç‡§ï‡§Æ</th>
			</tr>
		  </thead>
		  <tbody>
			<tr>
			  <td style="border: 1px solid #ccc; padding:">${selectedPipeSize} mm ‡§ó‡§µ‡•ç‡§π‡§æ‡§£</td>
			  <td style="border: 1px solid #ccc; padding: 8px;">${pipeQty}</td>
			  <td style="border: 1px solid #ccc; padding: 8px;">‚Çπ${pipePrice}</td>
			  <td style="border: 1px solid #ccc; padding: 8px; text-align:right; ">‚Çπ${pipeTotal}</td>
			</tr>
			<tr>
			  <td style="border: 1px solid #ccc; padding: 8px;">${standLabel}</td>
			  <td style="border: 1px solid #ccc; padding: 8px;">${standQty}</td>
			  <td style="border: 1px solid #ccc; padding: 8px;">‚Çπ${standPrice}</td>
			  <td style="border: 1px solid #ccc; padding: 8px; text-align:right;">‚Çπ${standTotal}</td>
			</tr>
			<tr>
			  <td style="border: 1px solid #ccc; padding: 8px;">‡§ï‡•Ö‡§™</td>
			  <td style="border: 1px solid #ccc; padding: 8px;">${capsQty}</td>
			  <td style="border: 1px solid #ccc; padding: 8px;">‚Çπ${capPrice}</td>
			  <td style="border: 1px solid #ccc; padding: 8px; text-align:right;">‚Çπ${capTotal}</td>
			</tr>
			
			<tr style="font-weight: bold; background-color: #f9f9f9;">
			  <td colspan="3" style="border: 1px solid #ccc; padding: 10px;">‡§è‡§ï‡•Ç‡§£</td>
			  <td style="border: 1px solid #ccc; padding: 10px; text-align:right;">‚Çπ${total}/-</td>
			</tr>
		  </tbody>
		</table>
	  `;

      document.getElementById("total").textContent = `‡§è‡§ï‡•Ç‡§£: ‚Çπ${total}/-`;
      nextStep();
    }


    function resetForm() {
      currentStep = 2;
      selectedPipeSize = null;
      selectedStandShape = null;
      selectedYStandWidth = null;
      document.querySelectorAll(".step").forEach(step => step.classList.remove("active"));
      document.getElementById("step2").classList.add("active");
      document.getElementById("summary").innerHTML = "";
      document.getElementById("total").textContent = "";
      document.getElementById("customerName").value = "";
      document.getElementById("customerPhone").value = "";
      populatePipeQty();
      populateCapsQty();
    }

    function populatePipeQty() {
      const select = document.getElementById("pipeQty");
      select.innerHTML = "";
      for (let i = 0; i <= 100; i++) {
        const opt = document.createElement("option");
        opt.value = i;
        opt.text = i;
        select.appendChild(opt);
      }
    }

    function populateCapsQty() {
      const select = document.getElementById("capsQty");
      select.innerHTML = "";
      for (let i = 0; i <= 100; i++) {
        const opt = document.createElement("option");
        opt.value = i;
        opt.text = i;
        if (i === 2) opt.selected = true;
        select.appendChild(opt);
      }
    }


    function startVoicePhone() {
      if ('webkitSpeechRecognition' in window) {
        const recognition = new webkitSpeechRecognition();
        recognition.lang = "mr-IN"; // You can change to "en-IN" if Marathi doesn't work well for numbers

        recognition.onresult = function (event) {
          let spokenText = event.results[0][0].transcript;
          // Remove all non-digit characters (like "‡§°‡§æ‡§∂", "‡§Ö‡§Å‡§°", etc.)
          spokenText = spokenText.replace(/\D/g, '');
          document.getElementById("customerPhone").value = spokenText;
        };

        recognition.start();
      } else {
        alert("‡§Ü‡§™‡§≤‡§æ ‡§¨‡•ç‡§∞‡§æ‡§â‡§ù‡§∞ ‡§Ü‡§µ‡§æ‡§ú ‡§ì‡§≥‡§ñ‡§§ ‡§®‡§æ‡§π‡•Ä.");
      }
    }

    function generateInvoiceImage() {

      const name = document.getElementById("customerName").value.trim();
      const phone = document.getElementById("customerPhone").value.trim();
      const transport = parseInt(document.getElementById("transportCost")?.value || 0);

      const pipeQty = parseInt(document.getElementById("pipeQty").value);
      const standQty = parseInt(document.getElementById("standQty").value);
      const capsQty = parseInt(document.getElementById("capsQty").value);
      const pipePrice = prices.pipe[selectedPipeSize];

      let paymentStatus = document.querySelector('input[name="paymentStatus"]:checked').value;


      let standPrice, standLabel;
      if (selectedPipeSize === 400) {
        standPrice = prices.stand[400];
        standLabel = "‡§∏‡•ç‡§ü‡§Å‡§°";
      } else if (selectedPipeSize === 800) {
        standPrice = prices.stand[800];
        standLabel = "‡§∏‡•ç‡§ü‡§Å‡§°";
      } else if (selectedStandShape === 'Y' && selectedPipeSize === 600) {
        standPrice = prices.stand[600][selectedYStandWidth];
        standLabel = selectedYStandWidth === 'Y6' ? '6 ‡§á‡§Ç‡§ö Y ‡§∏‡•ç‡§ü‡§Å‡§°' : '4 ‡§á‡§Ç‡§ö Y ‡§∏‡•ç‡§ü‡§Å‡§°';
      } else {
        standPrice = prices.stand[selectedPipeSize][selectedStandShape];
        standLabel = selectedStandShape === 'Square' ? '‡§ö‡•å‡§ï‡•ã‡§®‡•Ä ‡§∏‡•ç‡§ü‡§Å‡§°' : `${selectedStandShape} ‡§∏‡•ç‡§ü‡§Å‡§°`;
      }

      const capPrice = prices.cap[selectedPipeSize];

      const pipeTotal = pipeQty * pipePrice;
      const standTotal = standQty * standPrice;
      const capTotal = capsQty * capPrice;
      const total = pipeTotal + standTotal + capTotal + transport;


      let paidA;
      if (paymentStatus === "‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§¶‡§ø‡§≤‡•á") {
        paidA = parseInt(document.getElementById("paidAmount").value || total);
      }

      else if (paymentStatus === "‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§¨‡§æ‡§ï‡•Ä") {
        paidA = 0;

      }

      const remainingAmount = total - paidA;



      //const today = new Date().toLocaleDateString();

      const now = new Date();
      const day = String(now.getDate()).padStart(2, '0');
      const month = String(now.getMonth() + 1).padStart(2, '0');  // Months are 0-based
      const year = now.getFullYear();
      const today = `${day}/${month}/${year}`;


      const preview = document.getElementById("invoicePreview");
      preview.innerHTML = `
		<html>
		<head>
		  <title>‡§ó‡§µ‡•ç‡§π‡§æ‡§£ ‡§ï‡•ã‡§ü‡•á‡§∂‡§®  ‡§∂‡•ç‡§∞‡•Ä  </title>
		  <style>
			body { font-family: 'Segoe UI', sans-serif; padding: 20px; }
			
			.company-info { text-align: center; }
			.date { text-align: right; font-size: 16px; }
			table { width: 100%; border-collapse: collapse; margin-top: 20px; }
			th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
			th { background-color: #eef; }
		  </style>
		</head>
		<body>
			<h2 style="text-align:center; ">  || ‡§∂‡•ç‡§∞‡•Ä  ||</h2>
			
			<div class="header">
		  
				<div class="company-info">
				  
				  <h2>‡§∞‡§∏‡§æ‡§≥ ‡§∏‡§ø‡§Æ‡•á‡§Ç‡§ü ‡§™‡•ç‡§∞‡•â‡§°‡§ï‡•ç‡§ü‡•ç‡§∏</h2>
				  <p>‡§≤‡•ã‡§£‡•Ä ‡§∞‡•ã‡§°, ‡§ï‡•ã‡§≤‡•ç‡§π‡§æ‡§∞-‡§≠‡§ó‡§µ‡§§‡•Ä‡§™‡•Ç‡§∞, ‡§§‡§æ. ‡§∞‡§æ‡§π‡§æ‡§§‡§æ, ‡§ú‡§ø. ‡§Ö‡§π‡§ø‡§≤‡•ç‡§Ø‡§æ‡§®‡§ó‡§∞<br>Mob. 8805579296, 9623266922</p>
				</div>
			
			</div>
			
		  <h3 style="text-align:center; margin-top: 30px; margin-bottom: 30px; ">‡§ó‡§µ‡•ç‡§π‡§æ‡§£ ‡§ï‡•ã‡§ü‡•á‡§∂‡§®</h3>
		  
		  <div class="date">
				‡§¶‡§ø‡§®‡§æ‡§Ç‡§ï: ${today}
			</div>
			
		  <p><strong>‡§ó‡•ç‡§∞‡§æ‡§π‡§ï‡§æ‡§ö‡•á ‡§®‡§æ‡§µ:</strong> ${name}</p>
		  <p><strong>‡§´‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞:</strong> ${phone}</p>

		  <table>
			<thead>
			  <tr>
				<th>‡§µ‡§∏‡•ç‡§§‡•Ç</th>
				<th style="text-align:center;" >‡§®‡§ó</th>
				<th style="text-align:center;" >‡§¶‡§∞</th>
				<th style="text-align:center;" >‡§∞‡§ï‡•ç‡§ï‡§Æ</th>
			  </tr>
			</thead>
			<tbody>
			  <tr>
				<td>${selectedPipeSize} mm ‡§ó‡§µ‡•ç‡§π‡§æ‡§£</td>
				<td style="text-align:center;">${pipeQty}</td>
				<td style="text-align:center;">‚Çπ${pipePrice}</td>
				<td style="text-align:right;">‚Çπ${pipeTotal}</td>
			  </tr>
			  <tr>
				<td>${standLabel}</td>
				<td style="text-align:center;">${standQty}</td>
				<td style="text-align:center;">‚Çπ${standPrice}</td>
				<td style="text-align:right;">‚Çπ${standTotal}</td>
			  </tr>
			  <tr>
				<td>‡§ï‡•Ö‡§™</td>
				<td style="text-align:center;">${capsQty}</td>
				<td style="text-align:center;">‚Çπ${capPrice}</td>
				<td style="text-align:right;" >‚Çπ${capTotal}</td>
			  </tr>
			  <tr>
				<td>‡§µ‡§æ‡§π‡§§‡•Ç‡§ï ‡§ñ‡§∞‡•ç‡§ö</td>
				<td colspan="2"></td>
				<td style="text-align:right;">‚Çπ${transport}</td>
			  </tr>
			  
			  <tr style="font-weight: bold;">
				<td colspan="3">‡§è‡§ï‡•Ç‡§£</td>
				<td style="text-align:right;">‚Çπ${total}/-</td>
			  </tr>
			</tbody>
		  </table>
		  
		  <p><strong>‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§∏‡•ç‡§•‡§ø‡§§‡•Ä:</strong> ${paymentStatus}</p>
		  <p><strong>‡§¶‡§ø‡§≤‡•á‡§≤‡•Ä ‡§∞‡§ï‡•ç‡§ï‡§Æ:</strong> ‚Çπ${paidA}/-</p>
		  <p><strong>‡§∞‡§ï‡•ç‡§ï‡§Æ ‡§¨‡§æ‡§ï‡•Ä :</strong> ‚Çπ${remainingAmount}/-</p>

		  
		</body>
		</html>
	  `;

      preview.style.display = 'block';

      html2canvas(preview, {
        scale: 4,               // High scale for true pixel density
        backgroundColor: '#ffffff',
        useCORS: true,
        width: preview.scrollWidth,
        height: preview.scrollHeight

      }).then(canvas => {
        const link = document.createElement("a");
        link.download = `‡§ó‡§µ‡•ç‡§π‡§æ‡§£-‡§ï‡•ã‡§ü‡•á‡§∂‡§®-${today}.png`;
        link.href = canvas.toDataURL("image/png");
        link.click();


      });


    }

    function openWhatsAppChat() {

      const phone = document.getElementById("customerPhone").value.trim();
      const cleanPhone = phone.replace(/\D/g, '');
      const whatsappURL = `https://wa.me/91${cleanPhone}`;
      window.open(whatsappURL, '_blank');

    }


    function startVoice() {
      if ('webkitSpeechRecognition' in window) {
        const recognition = new webkitSpeechRecognition();
        recognition.lang = "mr-IN";
        recognition.onresult = function (event) {
          document.getElementById("customerName").value = event.results[0][0].transcript;
        };
        recognition.start();
      } else {
        alert("‡§Ü‡§™‡§≤‡§æ ‡§¨‡•ç‡§∞‡§æ‡§â‡§ù‡§∞ ‡§Ü‡§µ‡§æ‡§ú ‡§ì‡§≥‡§ñ‡§§ ‡§®‡§æ‡§π‡•Ä.");
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      populatePipeQty();
      populateCapsQty();
    });
  </script>
</body>

</html>


